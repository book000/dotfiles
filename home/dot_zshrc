# ユーザーローカルのbinディレクトリをPATHの先頭に追加
export PATH="$HOME/.local/bin:$PATH"

# エスケープシーケンスをフィルタリング
# DA2（Device Attributes 2）などのターミナル問い合わせ応答を破棄
# これにより、シェルプロンプトにエスケープシーケンスが表示される問題を回避
if [[ -t 0 && -t 1 ]]; then
  # 標準入力から不要なエスケープシーケンスを読み捨てる
  # タイムアウト 0.1 秒で読み取り可能なデータをクリア
  # zsh の read は -r オプションがないので、そのまま使用
  read -t 0.1 -k 10000 _discard 2>/dev/null || true
fi

# 追加の設定ファイルを読み込む
if [ -d "$HOME/.zshrc.d" ]; then
  # マッチするファイルがない場合にエラーを出さないようにする
  setopt nullglob
  # ~/.zshrc.d/ 以下の .zsh ファイルを辞書順に読み込む
  for f in ${(on)${(f)"$(LC_ALL=C print -rl -- "$HOME/.zshrc.d/"*.zsh | LC_ALL=C sort)"}}; do
    [ -r "$f" ] && source "$f"
  done
  unset f
  # オプションを元に戻す
  unsetopt nullglob
fi
